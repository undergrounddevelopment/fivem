<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FIVEM TOOLS V 7.0 CLEAN SCRIPTS FULL</title>
    <script src="https://js.puter.com/v2/"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif; background: linear-gradient(135deg, #0f0f1a 0%, #1a1a2e 100%); color: #e8e8f0; height: 100vh; overflow: hidden; }
        .container { display: flex; height: 100vh; }
        .sidebar { width: 280px; background: rgba(25, 25, 40, 0.95); backdrop-filter: blur(10px); border-right: 1px solid rgba(100, 100, 120, 0.2); display: flex; flex-direction: column; box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1); }
        .sidebar-header { padding: 24px 20px; border-bottom: 1px solid rgba(255, 105, 180, 0.15); background: linear-gradient(135deg, rgba(255, 20, 147, 0.15) 0%, transparent 100%); }
        .logo { display: flex; align-items: center; gap: 12px; font-size: 18px; font-weight: 700; color: #e8e8f0; margin-bottom: 20px; letter-spacing: 0.5px; }
        .new-chat-btn { display: flex; align-items: center; justify-content: center; gap: 10px; background: #4a5568; border: none; color: white; font-size: 14px; font-weight: 600; padding: 12px 20px; border-radius: 10px; cursor: pointer; transition: all 0.2s ease; }
        .new-chat-btn:hover { background: #5a6578; transform: translateY(-1px); }
        .plus-icon { width: 18px; height: 18px; background-color: rgba(255, 255, 255, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: bold; color: white; }
        .sidebar-nav { padding: 16px; border-bottom: 1px solid rgba(255, 105, 180, 0.2); }
        .nav-item { display: flex; align-items: center; gap: 12px; padding: 10px 12px; color: #a0a0b0; font-size: 14px; cursor: pointer; border-radius: 8px; transition: all 0.2s ease; }
        .nav-item:hover { color: #e8e8f0; background: rgba(100, 100, 120, 0.2); }
        .sidebar-content { flex: 1; padding: 16px; overflow-y: auto; }
        .section-title { font-size: 12px; color: #b794f6; margin-bottom: 12px; text-transform: uppercase; letter-spacing: 0.5px; }
        .recent-item { padding: 8px 0; color: #d4a5ff; font-size: 13px; cursor: pointer; transition: color 0.2s; line-height: 1.4; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .recent-item:hover { color: #ff69b4; }
        .sidebar-footer { padding: 16px; border-top: 1px solid rgba(255, 105, 180, 0.3); background: linear-gradient(0deg, rgba(255, 20, 147, 0.1) 0%, transparent 100%); }
        .user-info { display: flex; align-items: center; gap: 8px; cursor: pointer; }
        .user-avatar { width: 32px; height: 32px; background: linear-gradient(135deg, #ff1493 0%, #ff69b4 100%); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 700; color: white; box-shadow: 0 4px 15px rgba(255, 20, 147, 0.5); }
        .user-name { font-size: 14px; color: #fff; font-weight: 500; }
        .user-plan { font-size: 12px; color: #d4a5ff; }
        .main-content { flex: 1; display: flex; flex-direction: column; background: transparent; position: relative; z-index: 1; }
        .content-area { flex: 1; display: flex; flex-direction: column; padding: 20px; max-width: 800px; margin: 0 auto; width: 100%; position: relative; }
        .welcome-screen { display: flex; flex-direction: column; align-items: center; justify-content: center; flex: 1; padding: 40px; }
        .chat-container { display: none; flex-direction: column; height: 100vh; max-height: 100vh; overflow: hidden; }
        .chat-container.active { display: flex; }
        .chat-messages { flex: 1; overflow-y: auto; padding: 20px; margin-bottom: 20px; height: calc(100vh - 200px); scrollbar-width: thin; scrollbar-color: #404040 #262626; }
        .message { margin-bottom: 24px; display: flex; gap: 12px; }
        .message.user { flex-direction: row-reverse; }
        .message-avatar { width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 600; flex-shrink: 0; }
        .message.user .message-avatar { background: linear-gradient(135deg, #ff1493 0%, #ff69b4 100%); color: white; box-shadow: 0 4px 15px rgba(255, 20, 147, 0.5); }
        .message.assistant .message-avatar { background: linear-gradient(135deg, #8a2be2 0%, #9370db 100%); color: white; box-shadow: 0 4px 15px rgba(138, 43, 226, 0.5); }
        .message-content { max-width: 70%; background: rgba(20, 15, 30, 0.9); backdrop-filter: blur(20px); border-radius: 20px; padding: 18px; color: #f0e6ff; line-height: 1.7; word-wrap: break-word; box-shadow: 0 6px 30px rgba(138, 43, 226, 0.25); border: 1px solid rgba(255, 105, 180, 0.2); }
        .message.assistant .message-content { padding: 0; }
        .message-text-part { padding: 16px; white-space: pre-wrap; }
        .message.user .message-content { background: linear-gradient(135deg, #ff1493 0%, #ff69b4 100%); color: white; padding: 16px; box-shadow: 0 4px 25px rgba(255, 20, 147, 0.5); border: none; }
        .greeting { display: flex; align-items: center; gap: 16px; margin-bottom: 40px; font-size: 32px; font-weight: 700; color: #e8e8f0; letter-spacing: 1px; }
        .search-container { width: 100%; max-width: 600px; position: relative; margin-bottom: 20px; }
        .chat-container .search-container { position: sticky; bottom: 0; background-color: #1a1a1a; padding: 20px 0; margin: 0; max-width: none; }
        .search-input { width: 100%; padding: 16px 120px 16px 20px; background: rgba(30, 30, 45, 0.8); border: 1px solid rgba(100, 100, 120, 0.3); border-radius: 12px; color: #e8e8f0; font-size: 16px; outline: none; resize: none; min-height: 56px; max-height: 150px; font-family: inherit; }
        .search-input::placeholder { color: #b794f6; }
        .search-actions { position: absolute; right: 8px; top: 50%; transform: translateY(-50%); display: flex; gap: 4px; }
        .send-btn { padding: 10px; background: #4a5568; border: none; color: white; cursor: pointer; border-radius: 8px; display: flex; align-items: center; justify-content: center; }
        .send-btn:hover { background: #5a6578; }
        .model-btn { display: none; }
        .artifact-canvas { background: rgba(26, 10, 31, 0.9); border: 1px solid rgba(255, 105, 180, 0.3); border-radius: 8px; margin: 16px; overflow: hidden; }
        .artifact-header { display: flex; justify-content: space-between; align-items: center; background: rgba(45, 27, 61, 0.9); padding: 8px 12px; border-bottom: 1px solid rgba(255, 105, 180, 0.3); }
        .artifact-title { font-size: 13px; font-weight: 500; color: #ff69b4; }
        .artifact-actions { display: flex; gap: 8px; }
        .artifact-btn { background: none; border: 1px solid rgba(255, 105, 180, 0.4); color: #d4a5ff; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 12px; display: flex; align-items: center; gap: 4px; }
        .artifact-btn:hover { background: rgba(255, 20, 147, 0.2); color: #ff69b4; }
        .artifact-code { padding: 12px; max-height: 400px; overflow: auto; }
        .artifact-code code { font-family: 'SF Mono', 'Fira Code', 'Consolas', monospace; font-size: 13px; color: #f0e6ff; white-space: pre; }
        .banner-card { border-radius: 24px; background: rgba(20, 15, 30, 0.8); border: 2px solid rgba(255, 105, 180, 0.4); box-shadow: 0 10px 40px rgba(255, 20, 147, 0.3); overflow: hidden; }
        .banner-card:hover { transform: translateY(-15px) scale(1.03); box-shadow: 0 20px 60px rgba(255, 20, 147, 0.6); }
        .banner-img { width: 100%; height: auto; display: block; }
    </style>
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <img src="https://www.fivemtools.net/logo.gif" alt="Logo" style="width: 40px; height: 40px;">
                    FIVEM TOOLS V 7.0
                </div>
                <button class="new-chat-btn" id="newChatBtn">
                    <div class="plus-icon">+</div>
                    New chat
                </button>
            </div>
            <div class="sidebar-content">
                <div class="section-title">Recents</div>
                <div id="recentItems">
                    <div style="color: #666; font-size: 13px; font-style: italic; text-align: center;">No recent conversations</div>
                </div>
            </div>
            <div class="sidebar-footer">
                <div class="user-info">
                    <div class="user-avatar">V7</div>
                    <div style="flex: 1;">
                        <div class="user-name">V 7.0 TOOLS</div>
                        <div class="user-plan"><a href="https://fivemtools.net" target="_blank" style="color: #ff6b35; text-decoration: none;">fivemtools.net</a></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="content-area">
                <div class="welcome-screen" id="welcomeScreen">
                    <div class="greeting">FIVEM TOOLS V 7.0 CLEAN SCRIPTS</div>
                    
                    <div style="width: 100%; max-width: 900px; margin-bottom: 40px;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 25px; padding: 0 20px;">
                            <a href="https://fivemtools.net" target="_blank" style="text-decoration: none;">
                                <div class="banner-card">
                                    <img src="https://fixer.boostfivem.com/Capture1.png" alt="FiveM Tools" class="banner-img">
                                </div>
                            </a>
                            <a href="https://boostfivem.com" target="_blank" style="text-decoration: none;">
                                <div class="banner-card">
                                    <img src="https://fixer.boostfivem.com/Capture.png" alt="Boost FiveM" class="banner-img">
                                </div>
                            </a>
                        </div>
                    </div>
                    
                    <div class="search-container">
                        <textarea class="search-input" id="welcomeInput" placeholder="Ask anything about FiveM Scripts..." rows="1"></textarea>
                        <div class="search-actions">
                            <button class="send-btn" id="sendBtn">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <div style="max-width: 600px; margin-bottom: 15px; padding: 12px; background-color: #2a2a2a; border-radius: 8px;">
                        <div style="font-size: 13px; color: #b3b3b3; text-align: center; margin-bottom: 10px;">
                            <strong>First time?</strong> A small popup will appear for authentication
                        </div>
                        <div style="text-align: center;">
                            <button id="authButton" style="background-color: #ff6b35; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 12px;">
                                Authenticate with Puter
                            </button>
                        </div>
                    </div>
                    
                    <div style="align-self: flex-end; margin-bottom: 20px;">
                        <button class="model-btn" id="modelSelector">
                            <span id="currentModel">Claude Sonnet 4</span>
                        </button>
                    </div>
                </div>

                <div class="chat-container" id="chatContainer">
                    <div class="chat-messages" id="chatMessages"></div>
                    <div class="search-container">
                        <textarea class="search-input" id="chatInput" placeholder="Send message..." rows="1"></textarea>
                        <div class="search-actions">
                            <button class="send-btn" id="chatSendBtn">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const SYSTEM_PROMPT = `You are an expert FiveM Lua script cleaner. When cleaning obfuscated scripts, follow these rules:
1. De-obfuscation: Rename L2_2 style variables to readable names (entity, ped, vehicle)
2. Framework Bridging: Create auto-detect bridge for QBCore/ESX
3. Code Structure: Use 4-space indentation, add comments
4. Target System: Support qb-target, qtarget, ox_target dynamically
5. Output: Provide full functional clean Lua code that works 100% like original`;

        const models = [
            { apiName: 'claude-sonnet-4', displayName: 'V7 CLEAN V1' },
            { apiName: 'claude-opus-4', displayName: 'V7 CLEAN V2' },
            { apiName: 'claude-3-7-sonnet', displayName: 'V7 CLEAN V3' }
        ];
        let currentModel = models[0].apiName;
        let chatHistory = [];
        let isStreaming = false;

        document.addEventListener('DOMContentLoaded', init);

        function init() {
            document.getElementById('authButton')?.addEventListener('click', handleAuth);
            document.getElementById('sendBtn')?.addEventListener('click', handleWelcomeMessage);
            document.getElementById('chatSendBtn')?.addEventListener('click', handleChatMessage);
            document.getElementById('newChatBtn')?.addEventListener('click', startNewChat);
            document.getElementById('modelSelector')?.addEventListener('click', toggleModel);
            
            ['welcomeInput', 'chatInput'].forEach(id => {
                const el = document.getElementById(id);
                if (el) {
                    el.addEventListener('input', () => autoResize(el));
                    el.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter' && !e.shiftKey) {
                            e.preventDefault();
                            id === 'welcomeInput' ? handleWelcomeMessage() : handleChatMessage();
                        }
                    });
                }
            });
        }

        async function handleAuth() {
            const btn = document.getElementById('authButton');
            try {
                btn.textContent = 'Authenticating...';
                btn.disabled = true;
                await puter.ai.chat("test", {model: 'claude-sonnet-4'});
                btn.textContent = 'Authenticated';
                btn.style.backgroundColor = '#22c55e';
                setTimeout(() => btn.closest('div[style*="max-width"]').style.display = 'none', 2000);
            } catch (error) {
                btn.textContent = 'Auth Failed';
                btn.disabled = false;
                btn.style.backgroundColor = '#dc2626';
                alert('Authentication failed. Try Incognito mode or disable extensions.');
            }
        }

        function toggleModel() {
            const idx = models.findIndex(m => m.apiName === currentModel);
            currentModel = models[(idx + 1) % models.length].apiName;
            document.getElementById('currentModel').textContent = models.find(m => m.apiName === currentModel).displayName;
        }

        async function handleWelcomeMessage() {
            const input = document.getElementById('welcomeInput');
            const msg = input.value.trim();
            if (!msg || isStreaming) return;
            input.value = '';
            switchToChatView();
            await sendMessage(msg);
        }

        async function handleChatMessage() {
            const input = document.getElementById('chatInput');
            const msg = input.value.trim();
            if (!msg || isStreaming) return;
            input.value = '';
            autoResize(input);
            await sendMessage(msg);
        }

        function switchToChatView() {
            document.getElementById('welcomeScreen').style.display = 'none';
            document.getElementById('chatContainer').classList.add('active');
        }

        function startNewChat() {
            chatHistory = [];
            currentModel = models[0].apiName;
            document.getElementById('currentModel').textContent = models[0].displayName;
            document.getElementById('welcomeScreen').style.display = 'flex';
            document.getElementById('chatContainer').classList.remove('active');
            document.getElementById('chatMessages').innerHTML = '';
            document.getElementById('welcomeInput').value = '';
        }

        async function sendMessage(message) {
            if (isStreaming) return;
            addMessage(message, 'user');
            
            const msgs = chatHistory.length === 0 
                ? [{ role: 'user', content: SYSTEM_PROMPT + '\n\n' + message }]
                : [...chatHistory, { role: 'user', content: message }];
            
            chatHistory.push({ role: 'user', content: message });
            
            try {
                isStreaming = true;
                const response = await puter.ai.chat(msgs, { model: currentModel, stream: true });
                const { messageContent } = addMessage('', 'assistant');
                let fullResponse = '';
                
                for await (const part of response) {
                    if (part?.text) {
                        fullResponse += part.text;
                        renderMessage(fullResponse, messageContent);
                        scrollToBottom();
                    }
                }
                
                chatHistory.push({ role: 'assistant', content: fullResponse });
            } catch (error) {
                addMessage('Error: ' + error.message, 'assistant');
                if (chatHistory[chatHistory.length - 1].role === 'user') chatHistory.pop();
            } finally {
                isStreaming = false;
            }
        }

        function addMessage(content, role) {
            const container = document.getElementById('chatMessages');
            const div = document.createElement('div');
            div.className = `message ${role}`;
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = role === 'user' ? 'V7' : 'AI';
            
            const messageContent = document.createElement('div');
            messageContent.className = 'message-content';
            
            if (role === 'assistant') renderMessage(content, messageContent);
            else messageContent.textContent = content;
            
            div.appendChild(avatar);
            div.appendChild(messageContent);
            container.appendChild(div);
            scrollToBottom();
            
            return { messageContent };
        }

        function renderMessage(content, container) {
            container.innerHTML = '';
            const codeRegex = /```(\w*)\n([\s\S]*?)```/g;
            let lastIdx = 0;
            let match;

            while ((match = codeRegex.exec(content)) !== null) {
                if (match.index > lastIdx) {
                    const text = document.createElement('div');
                    text.className = 'message-text-part';
                    text.textContent = content.substring(lastIdx, match.index);
                    container.appendChild(text);
                }
                container.appendChild(createArtifact(match[2].trim(), match[1] || 'text'));
                lastIdx = match.index + match[0].length;
            }

            if (lastIdx < content.length) {
                const text = document.createElement('div');
                text.className = 'message-text-part';
                text.textContent = content.substring(lastIdx);
                container.appendChild(text);
            }
        }

        function createArtifact(code, lang) {
            const canvas = document.createElement('div');
            canvas.className = 'artifact-canvas';
            
            const header = document.createElement('div');
            header.className = 'artifact-header';
            header.innerHTML = `<div class="artifact-title">${lang} code</div>`;
            
            const actions = document.createElement('div');
            actions.className = 'artifact-actions';
            
            const copyBtn = document.createElement('button');
            copyBtn.className = 'artifact-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.onclick = () => {
                navigator.clipboard.writeText(code);
                copyBtn.textContent = 'Copied!';
                setTimeout(() => copyBtn.textContent = 'Copy', 2000);
            };
            
            const downloadBtn = document.createElement('button');
            downloadBtn.className = 'artifact-btn';
            downloadBtn.textContent = 'Download';
            downloadBtn.onclick = () => {
                const blob = new Blob([code], { type: 'text/plain' });
                const a = document.createElement('a');
                a.href = URL.createObjectURL(blob);
                a.download = `script.${lang === 'lua' ? 'lua' : 'txt'}`;
                a.click();
            };
            
            actions.appendChild(copyBtn);
            actions.appendChild(downloadBtn);
            header.appendChild(actions);
            
            const codeArea = document.createElement('div');
            codeArea.className = 'artifact-code';
            codeArea.innerHTML = `<pre><code>${code}</code></pre>`;
            
            canvas.appendChild(header);
            canvas.appendChild(codeArea);
            return canvas;
        }

        function scrollToBottom() {
            const el = document.getElementById('chatMessages');
            if (el) requestAnimationFrame(() => el.scrollTop = el.scrollHeight);
        }

        function autoResize(textarea) {
            if (!textarea) return;
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 150) + 'px';
        }
    </script>
</body>
</html>
